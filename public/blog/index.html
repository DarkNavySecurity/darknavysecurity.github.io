<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Blog | DARKNAVY</title>
<meta name=keywords content><meta name=description content="root"><meta name=author content="DARKNAVY"><link rel=canonical href=https://www.darknavy.org/blog/><link crossorigin=anonymous href=/assets/css/stylesheet.2613b1460fae4b99a98c033e33bde5e6a3af84ddb20236b732cefe33e3c0781e.css integrity="sha256-JhOxRg+uS5mpjAM+M73l5qOvhN2yAja3Ms7+M+PAeB4=" rel="preload stylesheet" as=style><link rel=icon href=https://www.darknavy.org/images/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://www.darknavy.org/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://www.darknavy.org/favicon-32x32.png><link rel=apple-touch-icon href=https://www.darknavy.org/apple-touch-icon.png><link rel=mask-icon href=https://www.darknavy.org/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate type=application/rss+xml href=https://www.darknavy.org/blog/index.xml><link rel=alternate hreflang=en href=https://www.darknavy.org/blog/><link rel=alternate hreflang=zh href=https://www.darknavy.org/zh/blog/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-LR4ZN1LSPS"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-LR4ZN1LSPS")}</script><meta property="og:url" content="https://www.darknavy.org/blog/"><meta property="og:site_name" content="DARKNAVY"><meta property="og:title" content="Blog"><meta property="og:description" content="root"><meta property="og:locale" content="en"><meta property="og:type" content="website"><meta property="og:image" content="https://www.darknavy.org/images/white_logo.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://www.darknavy.org/images/white_logo.png"><meta name=twitter:title content="Blog"><meta name=twitter:description content="DARKNAVY"><meta name=twitter:site content="@DarkNavyOrg"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Blog","item":"https://www.darknavy.org/blog/"}]}</script></head><body class="list dark" id=top><header class=header><nav class=nav><div class=logo><a href=https://www.darknavy.org/ accesskey=h title="  (Alt + H)"><img src=https://www.darknavy.org/images/darknavy_shenlan_dot.png alt aria-label=logo height=20></a><div class=logo-switches><ul class=lang-switch><li>|</li><li><a href=https://www.darknavy.org/zh/ title=Chinese aria-label=Chinese>Zh</a></li></ul></div></div><ul id=menu><li><a href=https://www.darknavy.org/ title=Home><span>Home</span></a></li><li><a href=https://www.darknavy.org/blog/ title=Blog><span class=active>Blog</span></a></li><li><a href=https://www.darknavy.org/darknavy_insight/ title=Insight><span>Insight</span></a></li><li><a href=https://www.darknavy.org/about/ title=About><span>About</span></a></li></ul></nav></header><main class=main><header class=page-header><div class=breadcrumbs><a href=https://www.darknavy.org/>Home</a></div><h1>Blog
<a href=/blog/index.xml title=RSS aria-label=RSS><svg viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" height="23"><path d="M4 11a9 9 0 019 9"/><path d="M4 4a16 16 0 0116 16"/><circle cx="5" cy="19" r="1"/></svg></a></h1></header><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>If the Person Who Finds a Web3 Hardware Wallet is a Hacker</h2></header><div class=entry-content><p>In 2024, Web3 security incidents caused by private key leaks have surged, resulting in estimated financial losses exceeding $855 million.
Private keys function as the sole credentials for blockchain accounts, controlling access to all associated on-chain assets like cryptocurrencies and NFTs. Due to the decentralized nature of blockchain, losing the private key means permanently losing account control, while leakage typically results in asset theft. Hardware wallets, utilizing techniques like offline private key storage and secure chips, have become the primary choice for asset protection.
...</p></div><footer class=entry-footer><span title='2025-03-30 10:00:52 +0800 CST'>March 30, 2025</span>&nbsp;·&nbsp;1465 words&nbsp;·&nbsp;DARKNAVY</footer><a class=entry-link aria-label="post link to If the Person Who Finds a Web3 Hardware Wallet is a Hacker" href=https://www.darknavy.org/blog/if_the_person_who_finds_a_web3_hardware_wallet_is_a_hacker/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>A First Glimpse of the Starlink User Ternimal</h2></header><div class=entry-content><p>I think the human race has no future if it doesn’t go to space. —— Stephen Hawking
Starlink is a low Earth orbit (LEO) satellite internet service provided by SpaceX. Users connect to near-Earth orbit satellites through a user terminal, which then connects to the internet via ground gateways.
As the new generation of satellites gradually incorporates laser links, some satellites can communicate with each other via laser. This both reduces reliance on ground stations and improves transmission efficiency, enhancing global coverage.
...</p></div><footer class=entry-footer><span title='2025-03-26 10:10:22 +0800 CST'>March 26, 2025</span>&nbsp;·&nbsp;992 words&nbsp;·&nbsp;DARKNAVY</footer><a class=entry-link aria-label="post link to A First Glimpse of the Starlink User Ternimal" href=https://www.darknavy.org/blog/a_first_glimpse_of_the_starlink_user_ternimal/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>Fatal Vulnerabilities Compromising DJI Control Devices</h2></header><div class=entry-content><p>As logistics drones weave through buildings and surveying equipment delineates urban landscapes, the capillaries of the low-altitude economy are sketching the future with millimeter-level precision.
DARKNAVY consistently focuses on the construction and breaching of drone security defenses. In this research, we discovered a fatal exploit chain in DJI remote control devices, leading to the complete compromise of the security defenses within the DJI remote controller. How can we assist industry leader DJI in fortifying its security defenses? What potential risks do these vulnerabilities reveal? Welcome to read this article.
...</p></div><footer class=entry-footer><span title='2025-03-21 10:01:19 +0800 CST'>March 21, 2025</span>&nbsp;·&nbsp;1593 words&nbsp;·&nbsp;DARKNAVY</footer><a class=entry-link aria-label="post link to Fatal Vulnerabilities Compromising DJI Control Devices" href=https://www.darknavy.org/blog/fatal_vulnerabilities_compromising_dji_control_devices/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>CVE-2024-5274: A Minor Flaw in V8 Parser Leading to Catastrophes</h2></header><div class=entry-content><p>In May of this year, we noticed that Chrome fixed a V8 vulnerability that was being exploited in the wild in this update. We quickly pinpointed the fix for this vulnerability and discovered that it was a rare bug in the Parser module, which piqued our interest greatly. This led to the following research.
From Patch to PoC First, let’s take a look at the patch for this vulnerability:
diff --git a/src/ast/scopes.cc b/src/ast/scopes.cc index 660fdd2e9ad..de4df35c0ad 100644 --- a/src/ast/scopes.cc +++ b/src/ast/scopes.cc @@ -2447,7 +2447,7 @@ bool Scope::MustAllocate(Variable* var) { var->set_is_used(); if (inner_scope_calls_eval_ && !var->is_this()) var->SetMaybeAssigned(); } - DCHECK(!var->has_forced_context_allocation() || var->is_used()); + CHECK(!var->has_forced_context_allocation() || var->is_used()); // Global variables do not need to be allocated. return !var->IsGlobalObjectProperty() && var->is_used(); } diff --git a/src/parsing/parser-base.h b/src/parsing/parser-base.h index 40914d39a4f..65c338f343f 100644 --- a/src/parsing/parser-base.h +++ b/src/parsing/parser-base.h @@ -2661,6 +2661,7 @@ typename ParserBase&lt;Impl>::BlockT ParserBase&lt;Impl>::ParseClassStaticBlock( } FunctionState initializer_state(&amp;function_state_, &amp;scope_, initializer_scope); + FunctionParsingScope body_parsing_scope(impl()); AcceptINScope accept_in(this, true); // Each static block has its own var and lexical scope, so make a new var The patch is very simple, the actual effective fix is just one line of code. This line introduces a variable of type FunctionParsingScope when parsing the static initialization block of a class. Let’s examine what this newly introduced variable does:
...</p></div><footer class=entry-footer><span title='2024-08-30 10:09:29 +0800 CST'>August 30, 2024</span>&nbsp;·&nbsp;2748 words&nbsp;·&nbsp;DARKNAVY</footer><a class=entry-link aria-label="post link to CVE-2024-5274: A Minor Flaw in V8 Parser Leading to Catastrophes" href=https://www.darknavy.org/blog/cve_2024_5274_a_minor_flaw_in_v8_parser_leading_to_catastrophes/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>Exploiting Steam: Usual and Unusual Ways in the CEF Framework</h2></header><div class=entry-content><p>Introduction The Chromium Embedded Framework (CEF) is an open-source framework that allows developers to embed the Chromium engine in their applications. Although CEF is widely employed in a range of popular software, including WeChat and the Epic Games Launcher, there has been little security research on it. In this article, we will use the Steam Client Browser (a CEF-based application) as an example to present the vulnerabilities we found and how we exploited them to build three Remote Code Execution (RCE) chains.
...</p></div><footer class=entry-footer><span title='2024-06-27 11:39:32 +0800 CST'>June 27, 2024</span>&nbsp;·&nbsp;2000 words&nbsp;·&nbsp;DARKNAVY</footer><a class=entry-link aria-label="post link to Exploiting Steam: Usual and Unusual Ways in the CEF Framework" href=https://www.darknavy.org/blog/exploiting_steam_usual_and_unusual_ways_in_the_cef_framework/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>AVSS Report: System Security Adversarial Capability Preliminary Evaluation of iOS, Android, and HarmonyOS - Kernel</h2></header><div class=entry-content><p>As consumers, when faced with five different brands and models of smartphones or ten different smart cars, it’s difficult for us to determine which one can effectively prevent our privacy from being stolen or maliciously accessed, such as our location or even hearing our conversations inside the car.
Even as ordinary consumers, we currently have no way of knowing. As technology professionals who have long studied in APT(Advanced Persistent Threat) attacks, we understand that these devices can ultimately be compromised in the face of advanced persistent attacks.
...</p></div><footer class=entry-footer><span title='2024-06-11 15:40:57 +0800 CST'>June 11, 2024</span>&nbsp;·&nbsp;2904 words&nbsp;·&nbsp;DARKNAVY</footer><a class=entry-link aria-label="post link to AVSS Report: System Security Adversarial Capability Preliminary Evaluation of iOS, Android, and HarmonyOS - Kernel" href=https://www.darknavy.org/blog/avss_report_kernel/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>Strengthening the Shield: MTE in Heap Allocators</h2></header><div class=entry-content><p>Introduction In 2018, with the release of ARMv8.5-A, a brand new chip security feature MTE (Memory Tagging Extensions) emerged. Five years later, in 2023, the first smartphone to support this feature was released — Google Pixel 8 — marking the official entry of MTE into the consumer market. Although this feature is not yet enabled by default, developers can turn it on themselves for testing.
As a powerful defense against memory corruption, there has not yet been a comprehensive analysis of MTE’s defensive boundaries, capabilities, and its impact on performance on the internet. Previously, Google Project Zero published a series of articles about MTE, focusing on the more low-level security aspects of MTE. However, the actual impact of MTE on real software security remains a mystery. To discuss this topic, heap allocators provide an excellent starting point. Heap memory corruption issues have gradually become the mainstream type of binary vulnerabilities. For reference, see the presentation by MSRC at CppCon 2019:
...</p></div><footer class=entry-footer><span title='2024-01-03 16:19:13 +0800 CST'>January 3, 2024</span>&nbsp;·&nbsp;2340 words&nbsp;·&nbsp;DARKNAVY</footer><a class=entry-link aria-label="post link to Strengthening the Shield: MTE in Heap Allocators" href=https://www.darknavy.org/blog/strengthening_the_shield_mte_in_memory_allocators/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>Exploiting the libwebp Vulnerability, Part 2: Diving into Chrome Blink</h2></header><div class=entry-content><p>Introduction When we examine a third-party library vulnerability in a real environment, we often encounter numerous complex variables that exist within the vulnerability’s context. Exploiting such a vulnerability is not as easy as one might imagine.
Here is the information we know:
The overflowed variable huffman_tables, has a size of 0x2f28. The heap chunk is allocated in the renderer’s ThreadPool, while most objects are allocated in the main thread. We can write a partially controlled 4-byte integer with an offset that is a multiple of 8 bytes. In Chrome, different-sized heap chunks are stored in separate buckets, isolating objects of different sizes to ensure security. Typically, achieving heap exploitation in Chrome requires identifying objects of the same size for layout purposes and then utilizing Use-After-Free (UAF) or Out-of-Bounds (OOB) techniques to manipulate other objects, leading to information disclosure or control-flow hijacking. In the following, we will share the objects we have discovered, as well as attempting to bypass this mechanism.
...</p></div><footer class=entry-footer><span title='2023-11-03 14:10:17 +0800 CST'>November 3, 2023</span>&nbsp;·&nbsp;1768 words&nbsp;·&nbsp;DARKNAVY</footer><a class=entry-link aria-label="post link to Exploiting the libwebp Vulnerability, Part 2: Diving into Chrome Blink" href=https://www.darknavy.org/blog/exploiting_the_libwebp_vulnerability_part_2/></a></article><article class=post-entry><header class=entry-header><h2 class=entry-hint-parent>Exploiting the libwebp Vulnerability, Part 1: Playing with Huffman Code</h2></header><div class=entry-content><p>Vulnerability Localization In the initial phase of vulnerability analysis, due to the absence of readily available PoCs or detailed analysis reports, we first attempted to read and understand the patch code for CVE-2023-4863 in the upstream repository of webmproject/libwebp. However, the WebM Project’s official patch was relatively complex, making it difficult for us to accurately pinpoint the root cause of the vulnerability.
Thus, we turned our attention to Apple’s official patch for CVE-2023-41064, and performed a comparison of the ImageIO framework before and after the update using BinDiff. We noticed that Apple’s patch involved fewer code changes and was much easier to understand.
...</p></div><footer class=entry-footer><span title='2023-11-03 14:10:12 +0800 CST'>November 3, 2023</span>&nbsp;·&nbsp;2345 words&nbsp;·&nbsp;DARKNAVY</footer><a class=entry-link aria-label="post link to Exploiting the libwebp Vulnerability, Part 1: Playing with Huffman Code" href=https://www.darknavy.org/blog/exploiting_the_libwebp_vulnerability_part_1/></a></article></main><footer class=footer><span>&copy; 2025 <a href=https://www.darknavy.org/>DARKNAVY</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script></body></html>