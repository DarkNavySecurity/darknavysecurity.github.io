<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>If the Person Who Finds a Web3 Hardware Wallet is a Hacker | DARKNAVY</title>
<meta name=keywords content><meta name=description content="In 2024, Web3 security incidents caused by private key leaks have surged, resulting in estimated financial losses exceeding $855 million.
Private keys function as the sole credentials for blockchain accounts, controlling access to all associated on-chain assets like cryptocurrencies and NFTs. Due to the decentralized nature of blockchain, losing the private key means permanently losing account control, while leakage typically results in asset theft. Hardware wallets, utilizing techniques like offline private key storage and secure chips, have become the primary choice for asset protection."><meta name=author content="DARKNAVY"><link rel=canonical href=https://www.darknavy.org/blog/if_the_person_who_finds_a_web3_hardware_wallet_is_a_hacker/><link crossorigin=anonymous href=/assets/css/stylesheet.2613b1460fae4b99a98c033e33bde5e6a3af84ddb20236b732cefe33e3c0781e.css integrity="sha256-JhOxRg+uS5mpjAM+M73l5qOvhN2yAja3Ms7+M+PAeB4=" rel="preload stylesheet" as=style><link rel=icon href=https://www.darknavy.org/images/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://www.darknavy.org/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://www.darknavy.org/favicon-32x32.png><link rel=apple-touch-icon href=https://www.darknavy.org/apple-touch-icon.png><link rel=mask-icon href=https://www.darknavy.org/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://www.darknavy.org/blog/if_the_person_who_finds_a_web3_hardware_wallet_is_a_hacker/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-LR4ZN1LSPS"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-LR4ZN1LSPS")}</script><meta property="og:url" content="https://www.darknavy.org/blog/if_the_person_who_finds_a_web3_hardware_wallet_is_a_hacker/"><meta property="og:site_name" content="DARKNAVY"><meta property="og:title" content="If the Person Who Finds a Web3 Hardware Wallet is a Hacker"><meta property="og:description" content="In 2024, Web3 security incidents caused by private key leaks have surged, resulting in estimated financial losses exceeding $855 million.
Private keys function as the sole credentials for blockchain accounts, controlling access to all associated on-chain assets like cryptocurrencies and NFTs. Due to the decentralized nature of blockchain, losing the private key means permanently losing account control, while leakage typically results in asset theft. Hardware wallets, utilizing techniques like offline private key storage and secure chips, have become the primary choice for asset protection."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="blog"><meta property="article:published_time" content="2025-03-30T10:00:52+08:00"><meta property="article:modified_time" content="2025-03-30T10:00:52+08:00"><meta property="og:image" content="https://www.darknavy.org/blog/if_the_person_who_finds_a_web3_hardware_wallet_is_a_hacker/attachments/7040d7d5-4672-4806-a6e3-ef920e3515da.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://www.darknavy.org/blog/if_the_person_who_finds_a_web3_hardware_wallet_is_a_hacker/attachments/7040d7d5-4672-4806-a6e3-ef920e3515da.png"><meta name=twitter:title content="If the Person Who Finds a Web3 Hardware Wallet is a Hacker"><meta name=twitter:description content="In 2024, Web3 security incidents caused by private key leaks have surged, resulting in estimated financial losses exceeding $855 million.
Private keys function as the sole credentials for blockchain accounts, controlling access to all associated on-chain assets like cryptocurrencies and NFTs. Due to the decentralized nature of blockchain, losing the private key means permanently losing account control, while leakage typically results in asset theft. Hardware wallets, utilizing techniques like offline private key storage and secure chips, have become the primary choice for asset protection."><meta name=twitter:site content="@DarkNavyOrg"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Blog","item":"https://www.darknavy.org/blog/"},{"@type":"ListItem","position":2,"name":"If the Person Who Finds a Web3 Hardware Wallet is a Hacker","item":"https://www.darknavy.org/blog/if_the_person_who_finds_a_web3_hardware_wallet_is_a_hacker/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"If the Person Who Finds a Web3 Hardware Wallet is a Hacker","name":"If the Person Who Finds a Web3 Hardware Wallet is a Hacker","description":"In 2024, Web3 security incidents caused by private key leaks have surged, resulting in estimated financial losses exceeding $855 million.\nPrivate keys function as the sole credentials for blockchain accounts, controlling access to all associated on-chain assets like cryptocurrencies and NFTs. Due to the decentralized nature of blockchain, losing the private key means permanently losing account control, while leakage typically results in asset theft. Hardware wallets, utilizing techniques like offline private key storage and secure chips, have become the primary choice for asset protection.\n","keywords":[],"articleBody":"In 2024, Web3 security incidents caused by private key leaks have surged, resulting in estimated financial losses exceeding $855 million.\nPrivate keys function as the sole credentials for blockchain accounts, controlling access to all associated on-chain assets like cryptocurrencies and NFTs. Due to the decentralized nature of blockchain, losing the private key means permanently losing account control, while leakage typically results in asset theft. Hardware wallets, utilizing techniques like offline private key storage and secure chips, have become the primary choice for asset protection.\nBut does the moment a hacker’s fingertip touches the metal casing of a hardware wallet, the Pandora’s box of the digital abyss truly open?\nIn this brief overview of attack and defense, we outline DARKNAVY’s research on Web3 hardware wallets from an adversarial perspective.\nAttack Surface Overview Mainstream hardware wallets available on the market, despite variations in form factor, are typically marketed with assertions of robust security designs. However, the efficacy of these proclaimed security features may not consistently meet expectations, and in some cases, might even introduce vulnerabilities. Although hardware wallets effectively reduce numerous attack surfaces through mechanisms like offline signing and simplified functionalities, this does not guarantee that the security of the remaining attack surfaces.\nDue to their offline nature, hardware wallets require external devices (e.g., browsers, mobile apps) to transmit transaction data for signing and to subsequently broadcast signed results to the blockchain. Certain wallets with small or absent displays provide configuration settings exclusively via an associated application, which in turn transmits the necessary configuration parameters to the wallet.\nBased on analysis of mainstream hardware wallets, We classify the typical connection methods between the hardware wallet and external entities and access the associated security risks.\nFirstly, three duplex communication interfaces have been identified: USB, NFC, and Bluetooth.\nThese three methods may harbor vulnerabilities in their data communication protocols and data processing, potentially leading to issues like memory corruption or sensitive information leakage. When an attacker has physical access to the device, these communication interfaces may further introduce security risks:\nUSB: Some wallets can emulate a USB flash drive,thereby increasing the attack surface; Additionally, certain devices support bootloader mode, granting access to lower-level functions via USB. NFC: Although physical proximity limits its exploitation, NFC communication remains susceptible to Man-in-the-Middle (MitM) attacks, which may allow an attacker to intercept and parse sensitive data. Bluetooth: Bluetooth communication itself has multiple risk points, such as pairing hijacking, MitM attacks, and data sniffing, and its range limit is much less restrictive than NFC’s. These communication methods connect the offline wallet to networked devices, raising concerns among users: What data is actually being transferred between the external device and the wallet? If the device is compromised, is the wallet still safe? Or, could the wallet and its accompanying app have built-in backdoors that surreptitiously upload wallet data after establishing a connection?\nTo address these concerns, hardware wallet manufacturers have introduced the concept of “Air Gapped,” physically isolating the wallet from network-connected devices. Two primary transmission methods adhere to this principle, both requiring user intervention to execute a one-way data transfer. The specific operation processes and risks are as follows:\nQR Code: The client first converts the data requiring a signature into a static or dynamic QR code. The hardware wallet, equipped with a camera, scans the QR code to retrieve the data and confirm the signature, and finally, the client scans the QR code displayed on the hardware wallet. Memory corruption issues might arise during the processes of image parsing and QR code recognition. SD Card: The client and the hardware wallet exchange signature request and signature result files in a specific format using a single SD card. Memory corruption issues may occur when parsing the file format. Besides attack surfaces exposed during communication, some hardware wallets also provide firmware update interfaces (commonly via USB, Bluetooth, or SD card mode). The update process typically involves hash calculations, signature verifications to ensure firmware integrity and authenticity, and version checks to prevent rollbacks. If the update process is poorly implemented, an attacker might be able to flash malicious firmware or an older, vulnerable firmware version.\nFurthermore, although most hardware wallets employ secure chips for private key storage, they remain vulnerable to physical attacks such as side-channel analysis and hardware fault injection.\nThe following sections will analyze the USB and NFC attack surfaces from an adversary’s perspective.\nUSB Attack Surface Many hardware wallets communicate with computers or mobile devices via USB. Based on the underlying USB HID protocol, each hardware wallet implements its own proprietary application-layer protocol that defines specific commands and response formats. Using the Cypherock X1 wallet as a case study, we outline the attack surface associated with USB connectivity.\nThe X1 runs a real-time embedded system that processes incoming USB requests. A complete USB command cycle begins with the desktop application cySync, which serializes the request via an SDK and transmits it to the X1 wallet over USB. The wallet processes the request and returns a data packet, repeating this circle until the command is fully executed.\nThe X1 wallet contains multiple applets. After reading the applet_id from the request via a USB event callback, the X1 invokes the corresponding applet for further processing.\nFrom an attacker’s perspective, the logic related to the device’s communication with the outside world is of greater interest: the device responds to requests via event callbacks, parsing protobuf data into structured data for processing; once request processing is complete, it directly calls an API to return a response to cySync.\nIn this process, if the X1 wallet lacks rigorous security checks when parsing and handling external request data, it could potentially be exploited by an attacker.\nNFC Attack Surface The tap-and-go nature of NFC technology has added convenience to modern life, and some hardware wallets have adopted this feature. Unlike entrance guard systems typically use M1 cards with basic storage functions, hardware wallets generally employ CPU cards capable of more complex authentication logic. The following presents our research of the NFC module in the Tangem wallet:\nTangem’s NFC communication operates in unencrypted, Fast encrypted, and Strong encrypted modes. By default, interactions begin in the unencrypted mode, where data is simply serialized. Encryption is only activated after the card responds with a NeedEncryption message, creating a window during which attackers can intercept plaintext data.\nNFC consists of a Tag side and a Reader side. From an attacker’s perspective, one can impersonate either side to communicate with the other.\nEvery time the Tangem app is launched, two tap operations are required. As shown above, we sniffed the NFC interaction data during the first tap. Following the standardized SELECT_UID and SELECT_AID operations, the Reader sends a ReadCommand instruction. Upon receiving the instruction, the card returns both card information and walletData.\nAs shown above, the ReadCommand requires three parameters: Pin, InteractionMode, and TerminalPublicKey. However, the card does not validate the Pin for this instruction. Therefore, an attacker can impersonate the Reader and access the card and walletData information simply by ’tapping’ the card:\nThese two pieces of information themselves do not contain highly sensitive data, prompting us to sniff the data from the second tap.\nDuring the second tap, the Reader sends the ReadWalletsList instruction. The card validates the Pin parameter within this instruction upon receipt. if successful, it returns all CardWallet information, and if failed, it returns the error code 6A F1.\nThus, brute-forcing the PIN using the response data appears to be a possible attack scenario. Fortunately, the manufacturer addresses this risk and introduces a security delay in the card: After 6 failed attempts, each subsequent failure increases the card’s response time by 1 second. However, according to comments in the client source code, this logic was introduced in version 1.21. Since Tangem cards do not support firmware updates, wallets purchased prior to version 1.21 remain more vulnerable to PIN brute-force attacks if the card is lost.\nTangem supports 33 custom NFC functions. Besides potential flaws in functional logic, memory-related vulnerabilities on the card also present a possible attack surface.\nConclusion Asset migration in the blockchain ecosystem never stops. What hardware wallets carry represents far more than a simple combination of physical chips and cryptographic algorithms; they are the ultimate experiment in entrusting ’trust’ to code.\nAsset migration in the blockchain ecosystem never stops. Hardware wallets represent more than just physical chips and cryptographic algorithms—they embody a fundamental experiment in transferring ’trust’ to code.\nAs attackers dissect hardware protection layers with surgical precision, the fragile reality of this trust experiment becomes clear: a single unnoticed buffer overflow, an inadequately isolated secure chip, or even a misplaced comment in the firmware code can become a critical flaw capable of undermining the entire system. In this ongoing battle over assets worth trillions, DARKNAVY’s research remains relentless.\nReference [1] https://www.certik.com/zh-CN/resources/blog/hack3d-the-web3-security-report-2024 [2] https://www.cypherock.com/ [3] https://tangem.com/ ","wordCount":"1465","inLanguage":"en","image":"https://www.darknavy.org/blog/if_the_person_who_finds_a_web3_hardware_wallet_is_a_hacker/attachments/7040d7d5-4672-4806-a6e3-ef920e3515da.png","datePublished":"2025-03-30T10:00:52+08:00","dateModified":"2025-03-30T10:00:52+08:00","author":{"@type":"Person","name":"DARKNAVY"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://www.darknavy.org/blog/if_the_person_who_finds_a_web3_hardware_wallet_is_a_hacker/"},"publisher":{"@type":"Organization","name":"DARKNAVY","logo":{"@type":"ImageObject","url":"https://www.darknavy.org/images/favicon.ico"}}}</script></head><body class=dark id=top><header class=header><nav class=nav><div class=logo><a href=https://www.darknavy.org/ accesskey=h title="  (Alt + H)"><img src=https://www.darknavy.org/images/darknavy_shenlan_dot.png alt aria-label=logo height=20></a><div class=logo-switches><ul class=lang-switch><li>|</li><li><a href=https://www.darknavy.org/zh/ title=Chinese aria-label=Chinese>Zh</a></li></ul></div></div><ul id=menu><li><a href=https://www.darknavy.org/ title=Home><span>Home</span></a></li><li><a href=https://www.darknavy.org/blog/ title=Blog><span>Blog</span></a></li><li><a href=https://www.darknavy.org/darknavy_insight/ title=Insight><span>Insight</span></a></li><li><a href=https://www.darknavy.org/about/ title=About><span>About</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://www.darknavy.org/>Home</a>&nbsp;»&nbsp;<a href=https://www.darknavy.org/blog/>Blog</a></div><h1 class="post-title entry-hint-parent">If the Person Who Finds a Web3 Hardware Wallet is a Hacker</h1><div class=post-meta><span title='2025-03-30 10:00:52 +0800 CST'>March 30, 2025</span>&nbsp;·&nbsp;1465 words&nbsp;·&nbsp;DARKNAVY</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#attack-surface-overview>Attack Surface Overview</a></li><li><a href=#usb-attack-surface>USB Attack Surface</a></li><li><a href=#nfc-attack-surface>NFC Attack Surface</a></li><li><a href=#conclusion>Conclusion</a></li><li><a href=#reference>Reference</a></li></ul></nav></div></details></div><div class=post-content><p>In 2024, Web3 security incidents caused by private key leaks have surged, resulting in estimated financial losses exceeding $855 million.</p><p>Private keys function as the sole credentials for blockchain accounts, controlling access to all associated on-chain assets like cryptocurrencies and NFTs. Due to the decentralized nature of blockchain, losing the private key means permanently losing account control, while leakage typically results in asset theft. <strong>Hardware wallets</strong>, utilizing techniques like offline private key storage and secure chips, have become the primary choice for asset protection.</p><p>But does the moment a hacker&rsquo;s fingertip touches the metal casing of a hardware wallet, the Pandora&rsquo;s box of the digital abyss truly open?</p><p>In this brief overview of attack and defense, we outline DARKNAVY&rsquo;s research on Web3 hardware wallets from an adversarial perspective.</p><p><img alt="DARKNAVY&rsquo;s Cracking of Popular Web3 Hardware Wallets" loading=lazy src=/blog/if_the_person_who_finds_a_web3_hardware_wallet_is_a_hacker/attachments/7040d7d5-4672-4806-a6e3-ef920e3515da.png></p><h2 id=attack-surface-overview>Attack Surface Overview<a hidden class=anchor aria-hidden=true href=#attack-surface-overview>#</a></h2><p>Mainstream hardware wallets available on the market, despite variations in form factor, are typically marketed with assertions of robust security designs. However, the efficacy of these proclaimed security features may not consistently meet expectations, and in some cases, might even introduce vulnerabilities. Although hardware wallets effectively reduce numerous attack surfaces through mechanisms like offline signing and simplified functionalities, <strong>this does not guarantee that the security of the remaining attack surfaces.</strong></p><p>Due to their offline nature, hardware wallets require external devices (e.g., browsers, mobile apps) to transmit transaction data for signing and to subsequently broadcast signed results to the blockchain. Certain wallets with small or absent displays provide configuration settings exclusively via an associated application, which in turn transmits the necessary configuration parameters to the wallet.</p><p>Based on analysis of mainstream hardware wallets, We classify the typical connection methods between the hardware wallet and external entities and access the associated security risks.</p><p>Firstly, three duplex communication interfaces have been identified: USB, NFC, and Bluetooth.</p><p>These three methods may harbor vulnerabilities in their data communication protocols and data processing, potentially leading to issues like memory corruption or sensitive information leakage. <strong>When an attacker has physical access to the device, these communication interfaces may further introduce security risks:</strong></p><ul><li><strong>USB:</strong> Some wallets can emulate a USB flash drive,thereby increasing the attack surface; Additionally, certain devices support bootloader mode, granting access to lower-level functions via USB.</li><li><strong>NFC:</strong> Although physical proximity limits its exploitation, NFC communication remains susceptible to Man-in-the-Middle (MitM) attacks, which may allow an attacker to intercept and parse sensitive data.</li><li><strong>Bluetooth:</strong> Bluetooth communication itself has multiple risk points, such as pairing hijacking, MitM attacks, and data sniffing, and its range limit is much less restrictive than NFC&rsquo;s.</li></ul><p><img alt="USB connection of Hardware Wallets" loading=lazy src=/blog/if_the_person_who_finds_a_web3_hardware_wallet_is_a_hacker/attachments/223ade8e-09ea-490c-9c6e-ecdc00e5c99d.png></p><p>These communication methods connect the offline wallet to networked devices, raising concerns among users: What data is actually being transferred between the external device and the wallet? If the device is compromised, is the wallet still safe? Or, could the wallet and its accompanying app have built-in backdoors that surreptitiously upload wallet data after establishing a connection?</p><p>To address these concerns, hardware wallet manufacturers have introduced the concept of &ldquo;Air Gapped,&rdquo; physically isolating the wallet from network-connected devices. Two primary transmission methods adhere to this principle, both requiring user intervention to execute a one-way data transfer. The specific operation processes and risks are as follows:</p><ul><li><strong>QR Code:</strong> The client first converts the data requiring a signature into a static or dynamic QR code. The hardware wallet, equipped with a camera, scans the QR code to retrieve the data and confirm the signature, and finally, the client scans the QR code displayed on the hardware wallet. Memory corruption issues might arise during the processes of image parsing and QR code recognition.</li><li><strong>SD Card:</strong> The client and the hardware wallet exchange signature request and signature result files in a specific format using a single SD card. Memory corruption issues may occur when parsing the file format.</li></ul><p><img alt="Using QR Code to obtain transaction information" loading=lazy src=/blog/if_the_person_who_finds_a_web3_hardware_wallet_is_a_hacker/attachments/f45f7110-e4c3-447c-9aef-fc31aa74121c.jpeg title=" =385x482"></p><p>Besides attack surfaces exposed during communication, some hardware wallets also provide firmware update interfaces (commonly via USB, Bluetooth, or SD card mode). The update process typically involves hash calculations, signature verifications to ensure firmware integrity and authenticity, and version checks to prevent rollbacks. If the update process is poorly implemented, an attacker might be able to flash malicious firmware or an older, vulnerable firmware version.</p><p><img alt="Firmware update process" loading=lazy src=/blog/if_the_person_who_finds_a_web3_hardware_wallet_is_a_hacker/attachments/f046cacb-ba9f-45b3-b2d2-3ff65fa7096b.jpeg title=" =214x300"></p><p>Furthermore, although most hardware wallets employ secure chips for private key storage, they remain vulnerable to physical attacks such as side-channel analysis and hardware fault injection.</p><p>The following sections will analyze the <strong>USB and NFC attack surfaces</strong> from an adversary&rsquo;s perspective.</p><h2 id=usb-attack-surface>USB Attack Surface<a hidden class=anchor aria-hidden=true href=#usb-attack-surface>#</a></h2><p>Many hardware wallets communicate with computers or mobile devices via USB. Based on the underlying USB HID protocol, each hardware wallet implements its own proprietary application-layer protocol that defines specific commands and response formats. Using the Cypherock X1 wallet as a case study, we outline the attack surface associated with USB connectivity.</p><p>The X1 runs a <strong>real-time embedded system</strong> that processes incoming USB requests. A complete USB command cycle begins with <strong>the desktop application cySync</strong>, which serializes the request via an SDK and transmits it to the X1 wallet over USB. The wallet processes the request and returns a data packet, repeating this circle until the command is fully executed.</p><p><img alt="USB communication with the X1 wallet via CLI" loading=lazy src=/blog/if_the_person_who_finds_a_web3_hardware_wallet_is_a_hacker/attachments/f911a6a2-3747-4a68-a800-c14beb2f9f91.png title=" =910x778"></p><p>The X1 wallet contains multiple applets. After reading the <code>applet_id</code> from the request via a USB event callback, the X1 invokes the corresponding applet for further processing.</p><p>From an attacker&rsquo;s perspective, the logic related to the device&rsquo;s communication with the outside world is of greater interest: the device responds to requests via event callbacks, parsing protobuf data into structured data for processing; once request processing is complete, it directly calls an API to return a response to cySync.</p><p>In this process, if the X1 wallet lacks rigorous security checks when parsing and handling external request data, it could potentially be exploited by an attacker.</p><p><img alt="USB Communication Between the X1 wallet and the External Device" loading=lazy src=/blog/if_the_person_who_finds_a_web3_hardware_wallet_is_a_hacker/attachments/7fe8a528-5fd4-43f7-aed6-e5de945fd2c6.png></p><h2 id=nfc-attack-surface>NFC Attack Surface<a hidden class=anchor aria-hidden=true href=#nfc-attack-surface>#</a></h2><p>The tap-and-go nature of NFC technology has added convenience to modern life, and some hardware wallets have adopted this feature. Unlike entrance guard systems typically use M1 cards with basic storage functions, hardware wallets generally employ CPU cards capable of more complex authentication logic. The following presents our research of the NFC module in the Tangem wallet:</p><p><img alt="The Tangem Hardware Wallet is s black NFC card" loading=lazy src=/blog/if_the_person_who_finds_a_web3_hardware_wallet_is_a_hacker/attachments/431a8fce-b163-4c4c-8d49-1375167e6589.png title=" =214x176"></p><p>Tangem&rsquo;s NFC communication operates in <strong>unencrypted, Fast encrypted, and Strong encrypted</strong> modes. By default, interactions begin in the unencrypted mode, where data is simply serialized. Encryption is only activated after the card responds with a <em>NeedEncryption</em> message, creating a window during which attackers can intercept plaintext data.</p><p><img alt="NFC Interaction Data Sniffed by PM3 During the First Tap" loading=lazy src=/blog/if_the_person_who_finds_a_web3_hardware_wallet_is_a_hacker/attachments/07a00307-c38c-4e09-91f8-e1e754610e17.png></p><blockquote><p>NFC consists of a Tag side and a Reader side. From an attacker&rsquo;s perspective, one can impersonate either side to communicate with the other.</p></blockquote><p>Every time the Tangem app is launched, two tap operations are required. As shown above, we sniffed the NFC interaction data during the first tap. Following the standardized SELECT_UID and SELECT_AID operations, the Reader sends a ReadCommand instruction. Upon receiving the instruction, the card returns both card information and walletData.</p><p><img alt="ReadCommand Parameters" loading=lazy src=/blog/if_the_person_who_finds_a_web3_hardware_wallet_is_a_hacker/attachments/821b981b-29b9-4d84-a260-1884ced95ede.png title=" =540x234"></p><p>As shown above, the ReadCommand requires three parameters: Pin, InteractionMode, and TerminalPublicKey. However, the card does not validate the Pin for this instruction. Therefore, an attacker can impersonate the Reader and access the card and walletData information simply by &rsquo;tapping&rsquo; the card:</p><p>These two pieces of information themselves do not contain highly sensitive data, prompting us to sniff the data from the second tap.</p><p><img alt="NFC Interaction Data Sniffed by PM3 During the Second Tap" loading=lazy src=/blog/if_the_person_who_finds_a_web3_hardware_wallet_is_a_hacker/attachments/59192e25-ea20-4d11-9094-4c6566bc7af1.png></p><p>During the second tap, the Reader sends the ReadWalletsList instruction. The card validates the Pin parameter within this instruction upon receipt. if successful, it returns all CardWallet information, and if failed, it returns the error code 6A F1.</p><p>Thus, brute-forcing the PIN using the response data appears to be a possible attack scenario. Fortunately, the manufacturer addresses this risk and introduces a security delay in the card: After 6 failed attempts, each subsequent failure increases the card&rsquo;s response time by 1 second. However, according to comments in the client source code, this logic was introduced in version 1.21. Since Tangem cards do not support firmware updates, wallets purchased prior to version 1.21 remain more vulnerable to PIN brute-force attacks if the card is lost.</p><p>Tangem supports 33 custom NFC functions. Besides potential flaws in functional logic, memory-related vulnerabilities on the card also present a possible attack surface.</p><p><img alt="Pre-1.21 Cards Lack the Security Delay Function, Delay is implemented Only in the App" loading=lazy src=/blog/if_the_person_who_finds_a_web3_hardware_wallet_is_a_hacker/attachments/7570c154-fddf-4f5c-bde5-0db3622a48ca.png title=" =514x234"></p><h2 id=conclusion>Conclusion<a hidden class=anchor aria-hidden=true href=#conclusion>#</a></h2><p>Asset migration in the blockchain ecosystem never stops. What hardware wallets carry represents far more than a simple combination of physical chips and cryptographic algorithms; they are the ultimate experiment in entrusting &rsquo;trust&rsquo; to code.</p><blockquote><p>Asset migration in the blockchain ecosystem never stops. Hardware wallets represent more than just physical chips and cryptographic algorithms—they embody a fundamental experiment in transferring &rsquo;trust&rsquo; to code.</p></blockquote><p>As attackers dissect hardware protection layers with surgical precision, the fragile reality of this trust experiment becomes clear: a single unnoticed buffer overflow, an inadequately isolated secure chip, or even a misplaced comment in the firmware code can become a critical flaw capable of undermining the entire system. In this ongoing battle over assets worth trillions, DARKNAVY&rsquo;s research remains relentless.</p><h2 id=reference>Reference<a hidden class=anchor aria-hidden=true href=#reference>#</a></h2><ul><li>[1] <a href=https://www.certik.com/zh-CN/resources/blog/hack3d-the-web3-security-report-2024>https://www.certik.com/zh-CN/resources/blog/hack3d-the-web3-security-report-2024</a></li><li>[2] <a href=https://www.cypherock.com/>https://www.cypherock.com/</a></li><li>[3] <a href=https://tangem.com/>https://tangem.com/</a></li></ul></div><footer class=post-footer><ul class=post-tags></ul><nav class=paginav><a class=next href=https://www.darknavy.org/blog/a_first_glimpse_of_the_starlink_user_ternimal/><span class=title>Next »</span><br><span>A First Glimpse of the Starlink User Ternimal</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://www.darknavy.org/>DARKNAVY</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script></body></html>